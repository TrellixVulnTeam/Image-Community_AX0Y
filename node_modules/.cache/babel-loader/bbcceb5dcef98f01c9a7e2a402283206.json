{"ast":null,"code":"import { createAction, handleAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\nimport { setCookie, getCookie, deleteCookie } from \"../../shared/Cookie\";\nimport { auth } from \"../../shared/firebase\";\nimport firebase from \"firebase/app\"; //액션타입 3가지\n\nconst LOG_OUT = \"LOG_OUT\";\nconst GET_USER = \"GET_USER\";\nconst SET_USER = \"SET_USER\"; // action creators\n\nconst logOut = createAction(LOG_OUT, user => ({\n  user\n}));\nconst getUser = createAction(GET_USER, user => ({\n  user\n}));\nconst setUser = createAction(SET_USER, user => ({\n  user\n})); //initialState\n\nconst initialState = {\n  user: null,\n  is_login: false\n};\nconst user_initial = {\n  user_name: \"pear111\"\n}; //middleware actions\n\nconst loginFB = (id, pwd) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then(res => {\n      auth.signInWithEmailAndPassword(id, pwd).then(user => {\n        console.log(user);\n        dispatch(setUser({\n          user_name: user.user.displayName,\n          id: id,\n          user_profile: \"\",\n          uid: user.user.uid\n        }));\n        history.push(\"/\"); // Signed in\n        // ...\n      }).catch(error => {\n        var errorCode = error.code;\n        var errorMessage = error.message;\n      });\n    });\n  };\n};\n\nconst signupFB = (id, pwd, user_name) => {\n  return function (dispatch, getState, {\n    history\n  }) {\n    auth.createUserWithEmailAndPassword(id, pwd).then(user => {\n      console.log(user);\n      auth.currentUser.updateProfile({\n        displayName: user_name\n      }).then(() => {\n        dispatch(setUser({\n          user_name: user_name,\n          id: id,\n          user_profile: \"\",\n          uid: user.user.uid\n        }));\n        history.push(\"/\");\n      }).catch(error => {\n        console.log(error);\n      }); // Signed in\n      // ...\n    }).catch(error => {\n      var errorCode = error.code;\n      var errorMessage = error.message;\n      console.log(errorCode, errorMessage); // ..\n    });\n  };\n}; //reducer\n\n\nexport default handleActions({\n  [SET_USER]: (state, action) => produce(state, draft => {\n    setCookie(\"is_login\", \"success\");\n    draft.user = action.payload.user; //payload를 중간에 거쳐야 한다.\n\n    draft.is_login = true;\n  }),\n  [LOG_OUT]: (state, action) => produce(state, draft => {\n    deleteCookie(\"is_login\");\n    draft.user = null;\n    draft.is_login = false;\n  }),\n  [GET_USER]: (state, action) => produce(state, draft => {})\n}, initialState); // action creator export\n\nconst actionCreators = {\n  logOut,\n  getUser,\n  signupFB,\n  loginFB\n};\nexport { actionCreators };","map":{"version":3,"sources":["/Users/jeongeunchoi/REACT_MIDDLEAGE/image-community/src/redux/modules/user.js"],"names":["createAction","handleAction","handleActions","produce","setCookie","getCookie","deleteCookie","auth","firebase","LOG_OUT","GET_USER","SET_USER","logOut","user","getUser","setUser","initialState","is_login","user_initial","user_name","loginFB","id","pwd","dispatch","getState","history","setPersistence","Auth","Persistence","SESSION","then","res","signInWithEmailAndPassword","console","log","displayName","user_profile","uid","push","catch","error","errorCode","code","errorMessage","message","signupFB","createUserWithEmailAndPassword","currentUser","updateProfile","state","action","draft","payload","actionCreators"],"mappings":"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","sourcesContent":["import { createAction, handleAction, handleActions } from \"redux-actions\";\nimport { produce } from \"immer\";\n\nimport { setCookie, getCookie, deleteCookie } from \"../../shared/Cookie\";\nimport { auth } from \"../../shared/firebase\";\nimport firebase from \"firebase/app\";\n\n//액션타입 3가지\nconst LOG_OUT = \"LOG_OUT\";\nconst GET_USER = \"GET_USER\";\nconst SET_USER = \"SET_USER\";\n\n// action creators\nconst logOut = createAction(LOG_OUT, (user) => ({ user }));\nconst getUser = createAction(GET_USER, (user) => ({ user }));\nconst setUser = createAction(SET_USER, (user) => ({ user }));\n\n//initialState\nconst initialState = {\n  user: null,\n  is_login: false,\n};\n\nconst user_initial = {\n  user_name: \"pear111\",\n};\n\n//middleware actions\nconst loginFB = (id, pwd) => {\n  return function (dispatch, getState, { history }) {\n    auth.setPersistence(firebase.auth.Auth.Persistence.SESSION).then((res) => {\n      auth\n        .signInWithEmailAndPassword(id, pwd)\n        .then((user) => {\n          console.log(user);\n\n          dispatch(\n            setUser({\n              user_name: user.user.displayName,\n              id: id,\n              user_profile: \"\",\n              uid: user.user.uid,\n            })\n          );\n          history.push(\"/\");\n\n          // Signed in\n          // ...\n        })\n        .catch((error) => {\n          var errorCode = error.code;\n          var errorMessage = error.message;\n        });\n    });\n  };\n};\n\nconst signupFB = (id, pwd, user_name) => {\n  return function (dispatch, getState, { history }) {\n    auth\n      .createUserWithEmailAndPassword(id, pwd)\n      .then((user) => {\n        console.log(user);\n\n        auth.currentUser\n          .updateProfile({\n            displayName: user_name,\n          })\n          .then(() => {\n            dispatch(\n              setUser({ user_name: user_name, id: id, user_profile: \"\", uid: user.user.uid })\n            );\n            history.push(\"/\");\n          })\n          .catch((error) => {\n            console.log(error);\n          });\n        // Signed in\n        // ...\n      })\n      .catch((error) => {\n        var errorCode = error.code;\n        var errorMessage = error.message;\n\n        console.log(errorCode, errorMessage);\n        // ..\n      });\n  };\n};\n\n//reducer\n\nexport default handleActions(\n  {\n    [SET_USER]: (state, action) =>\n      produce(state, (draft) => {\n        setCookie(\"is_login\", \"success\");\n        draft.user = action.payload.user; //payload를 중간에 거쳐야 한다.\n        draft.is_login = true;\n      }),\n    [LOG_OUT]: (state, action) =>\n      produce(state, (draft) => {\n        deleteCookie(\"is_login\");\n        draft.user = null;\n        draft.is_login = false;\n      }),\n\n    [GET_USER]: (state, action) => produce(state, (draft) => {}),\n  },\n  initialState\n);\n\n// action creator export\nconst actionCreators = {\n  logOut,\n  getUser,\n  signupFB,\n  loginFB,\n};\n\nexport { actionCreators };\n"]},"metadata":{},"sourceType":"module"}